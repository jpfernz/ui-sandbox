<div class="time-box-container">
  <h1>Time Box</h1>

  <div class="start-time-input">
    <mat-form-field appearance="outline">
      <mat-label>Start Time (GMT)</mat-label>
      <input
        matInput
        type="time"
        [(ngModel)]="startTimeInput"
        (ngModelChange)="onStartTimeChange($event)"
        data-testid="start-time-input"
      />
    </mat-form-field>
  </div>

  <div cdkDropList class="example-list" (cdkDropListDropped)="drop($event)">
    @for(item of mockTimeBlocks; track item; let i = $index) {
    <div
      class="example-box"
      cdkDrag
      [attr.data-testid]="'time-block-' + item.position"
    >
      <div class="example-custom-placeholder" *cdkDragPlaceholder></div>
      <div class="time-block-content">
        <div
          class="time-block-info"
          (click)="editTimeBlock(i)"
          (keydown.enter)="editTimeBlock(i)"
          (keydown.space)="editTimeBlock(i)"
          [attr.data-testid]="'time-block-info-' + item.position"
          tabindex="0"
          role="button"
          title="Click to edit"
        >
          <div
            [attr.data-testid]="'description-' + item.position"
            class="description"
          >
            {{ item.description }}
          </div>
          <div
            [attr.data-testid]="'time-info-' + item.position"
            class="time-info"
          >
            {{ item.startTime ? (item.startTime | date:'HH:mm':'GMT') : '--:--'
            }} - {{ item.endTime ? (item.endTime | date:'HH:mm':'GMT') : '--:--'
            }} ({{ item.duration }}m)
          </div>
        </div>
        <button
          mat-icon-button
          color="warn"
          class="delete-button"
          (click)="deleteTimeBlock(i)"
          [attr.data-testid]="'delete-button-' + item.position"
          title="Delete time block"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
    }
  </div>

  <div class="actions-container">
    <button
      mat-flat-button
      data-testid="add-time-block-button"
      (click)="addTimeBlock()"
      title="Add Time Block (Press T)"
    >
      Add <u>T</u>ime Block
    </button>

    <div class="data-actions">
      <button
        mat-stroked-button
        color="primary"
        data-testid="save-data-button"
        (click)="saveTimeBoxData()"
        title="Save time box data to JSON file"
      >
        <mat-icon>save</mat-icon>
        Save Data
      </button>

      <button
        mat-stroked-button
        color="accent"
        data-testid="load-data-button"
        (click)="loadTimeBoxData()"
        title="Load time box data from JSON file"
      >
        <mat-icon>upload</mat-icon>
        Load Data
      </button>

      <button
        mat-stroked-button
        data-testid="load-example-button"
        (click)="loadExampleData()"
        title="Load example time box data"
      >
        <mat-icon>description</mat-icon>
        Load Example
      </button>
    </div>
  </div>
</div>
